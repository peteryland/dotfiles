#!/bin/bash

case "$1" in
  *.csv)
    type csv >& /dev/null && csv "$1"
    ;;
  *.lhs|*.hs)
    type HsColour >& /dev/null && HsColour "$1"
    ;;
  *.json)
    type jq >& /dev/null && jq -C . "$1"
    ;;
  *)
    # We don't handle this format specially

    if [[ -x /usr/local/bin/lesspipe.sh ]]; then
      # for Mac, chain to /usr/local
      /usr/local/bin/lesspipe.sh "$1"
      exit $?
    else
      if [[ -f $1 && -r $1 ]]; then
        if [[ -x /usr/bin/batcat ]]; then
          /usr/bin/batcat --paging=never --wrap=never --color=always "$1"
        elif [[ -x /usr/bin/bat ]]; then
          /usr/bin/bat --paging=never --wrap=never --color=always "$1"
        fi
      else
        exit 1
      fi
    fi
esac

# No further processing by lesspipe necessary
exit 0
